process USER =  {
  include "FWCore/MessageLogger/data/MessageLogger.cfi"
  replace MessageLogger.cerr.FwkReport.reportEvery = 100

  source = PoolSource 
  { 
    untracked vstring fileNames = { 
     # "dcap://dcache-ses-cms.desy.de/pnfs/desy.de/cms/tier2/store/CSA07/skim/2008/1/17/CSA07-CSA07Muon-Chowder-A3-PDMuon-ReReco-100pb-Skims4/0000/08A0A10B-25C5-DC11-BE27-001617C3B6B4.root" 
    "file:/rdata2/desy-cms001/data/dammann/data/test/gumbo.root" 
    }
  }
# include "TopAnalysis/Configuration/data/SourceInput.cff"
  untracked PSet maxEvents = {untracked int32 input = 1000}

# TQAF Layer 1 TopObject production
  include "TopQuarkAnalysis/TopObjectProducers/data/TQAFLayer1.cff"
  sequence tqaf = {tqafLayer1}

# reconstruction sequence needed for this sample
  include "Configuration/StandardSequences/data/FakeConditions.cff"
  include "Configuration/StandardSequences/data/Reconstruction.cff"
  sequence rec = {reconstruction}

# additional modules needed for this sample
  include "PhysicsTools/HepMCCandAlgos/data/genEventRunInfo.cfi"
  include "PhysicsTools/HepMCCandAlgos/data/genEventProcID.cfi"
  include "PhysicsTools/HepMCCandAlgos/data/genEventScale.cfi"
  sequence gen = {genEventRunInfo, genEventProcID, genEventScale}

# add event weight
  include "TopAnalysis/TopUtils/data/EventWeight.cfi"
# replace csa07Event.talkToMe = true
  sequence wght = {gen, makeWeights} 

# add process id filter
  include "TopAnalysis/TopUtils/data/CSA07ProcessIdFilter.cfi"
# replace csa07Processes.csa07Ids = {  0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10 } # w+jet (chowder)
# replace csa07Processes.csa07Ids = { 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21 } # z+jet (chowder)
# replace csa07Processes.csa07Ids = { 22, 23, 24, 25, 26 }                         # ttbar (chowder)
# replace csa07Processes.csa07Ids = { 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38,
#                                     39, 40, 41, 42, 43, 44, 45, 46, 47 }         # qcd (gumbo)
  replace csa07Processes.csa07Ids = { 70 }                                         # qcd (mu enriched)
  sequence proc = {csa07Processes}
  path prep = {wght, rec, tqaf}

# preselection
  include "TopAnalysis/TopFilter/data/filterSequences/semiLepMuonSelection_prefilt.cff" 
  path semiMu = {makeSemiReference, makeSemiMuonSelection, makeSemiJetsSelection}

  include "TopAnalysis/TopFilter/data/filterSequences/diLepMuMuSelection_prefilt.cff" 
  path diMuMu = {makeDiReference, makeDiMuonSelection, makeDiJetsSelection}

# file service
  service = TFileService {
    string fileName = "analyzeSemiDiLepMuSelection_QcdMu.root"
  }

# output selection
  block EventSelection = {
    untracked PSet SelectEvents = {
      vstring SelectEvents = { "semiMu", "diMuMu" }
    }
  }

# define the event content
  block tqafEventContent = {
    untracked vstring outputCommands = {
      "drop *"
    }
  }

# event content 
  include "Configuration/EventContent/data/EventContent.cff"
  replace tqafEventContent.outputCommands += AODSIMEventContent.outputCommands
  replace tqafEventContent.outputCommands += {"keep *_*_*_USER"}

  module out = PoolOutputModule 
  { 
    untracked string fileName = "semiDiLepMuSelection_QcdMu.root" 
    using EventSelection
    using tqafEventContent
  }
  endpath p = {proc, out}
}
