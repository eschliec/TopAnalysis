process Test = {
# output level
  include "FWCore/MessageService/data/MessageLogger.cfi"
  replace MessageLogger.cerr.FwkReport.reportEvery = 1000
  #supress controloutput of the IsolationAnalyzer
  #replace MessageLogger.suppressInfo    = { "IsolationAnalyzer" }
  #replace MessageLogger.suppressInfo    = { "MatrixAnalyzer" }


# input file(s)
  include "TopAnalysis/Configuration/data/SourceInput.cff"
  untracked PSet maxEvents = {untracked int32 input = -1}

# make final event selection
  module trackIsoFilter = semiLepMuonEvent from "TopAnalysis/TopFilter/data/combinedFilters/SemiLepMuonEventFilter.cfi"
  module caloIsoFilter = semiLepMuonEvent from "TopAnalysis/TopFilter/data/combinedFilters/SemiLepMuonEventFilter.cfi"
  module jetIsoFilter = semiLepMuonEvent from "TopAnalysis/TopFilter/data/combinedFilters/SemiLepMuonEventFilter.cfi"
module allFilter = semiLepMuonEvent from "TopAnalysis/TopFilter/data/combinedFilters/SemiLepMuonEventFilter.cfi"  
  
  replace trackIsoFilter.useTrkIso = true
  replace trackIsoFilter.useCalIso = false
  replace trackIsoFilter.useJetIso = false
  
  replace caloIsoFilter.useTrkIso = false
  replace caloIsoFilter.useCalIso = true
  replace caloIsoFilter.useJetIso = false
  
  replace jetIsoFilter.useTrkIso = false
  replace jetIsoFilter.useCalIso = false
  replace jetIsoFilter.useJetIso = true  

  # TQAF Layer 2 for the ttbar semi-leptonic final state
  include "TopQuarkAnalysis/TopEventProducers/data/TtGenEvtProducer.cff"
 # include "TopQuarkAnalysis/TopEventProducers/data/TtSemiEventBuilder.cff"
  
  # add event weight
  include "TopAnalysis/TopUtils/data/EventWeight.cfi"

#Background analyzer
  module trackmbefore = matrixmodule from "TopAnalysis/TopAnalyzer/data/MatrixAnalyzer.cfi"
  module trackmafter = matrixmodule from "TopAnalysis/TopAnalyzer/data/MatrixAnalyzer.cfi"
  
  module calombefore = matrixmodule from "TopAnalysis/TopAnalyzer/data/MatrixAnalyzer.cfi"
  module calomafter = matrixmodule from "TopAnalysis/TopAnalyzer/data/MatrixAnalyzer.cfi"
  
  module jetIsombefore = matrixmodule from "TopAnalysis/TopAnalyzer/data/MatrixAnalyzer.cfi"
  module jetIsomafter = matrixmodule from "TopAnalysis/TopAnalyzer/data/MatrixAnalyzer.cfi"
  
  module allmbefore = matrixmodule from "TopAnalysis/TopAnalyzer/data/MatrixAnalyzer.cfi"
  module allmafter = matrixmodule from "TopAnalysis/TopAnalyzer/data/MatrixAnalyzer.cfi"
  
  include "TopAnalysis/TopAnalyzer/data/IsolationAnalyzer.cfi"
  #ttbar only
  replace analyzeisolationMET.ttbarMC = false
  
  #cuts
  include "TopAnalysis/TopFilter/data/semiLepMuonSelection_fin.cff"
  
  replace trackmafter.pmn = "trackmbefore"
  replace calomafter.pmn = "calombefore"
  replace jetIsomafter.pmn = "jetIsombefore"
  replace allmafter.pmn = "allmbefore"

  replace trackmbefore.before = true
  replace calombefore.before = true
  replace jetIsombefore.before = true
  replace allmbefore.before = true

# file service
  service = TFileService {
    string fileName = "analyzeQCDBackground_zjet_240708.root"
  }
  
  include "TopQuarkAnalysis/TopEventProducers/data/TtSemiLeptonicFilter.cfi"
  replace ttSemiLeptonicFilter.channel_1 = {0,1,0}

  path p0 = {makeWeights & makeGenEvt, analyzeisolationMET}
  path p1 = {trackmbefore, trackIsoFilter, trackmafter}
  path p2 = {calombefore, caloIsoFilter, calomafter}
  path p3 = {jetIsombefore, jetIsoFilter, jetIsomafter}
  path p4 = {allmbefore,allFilter,  allmafter}
  #ttbar MC
  #path p0 = {makeWeights & makeGenEvt, ttSemiLeptonicFilter, analyzeisolationMET}
  #path p1 = {makeWeights & makeGenEvt,ttSemiLeptonicFilter,trackmbefore, trackIsoFilter, trackmafter}
  #path p2 = {makeWeights & makeGenEvt,ttSemiLeptonicFilter,calombefore, caloIsoFilter, calomafter}
  #path p3 = {makeWeights & makeGenEvt,ttSemiLeptonicFilter, jetIsombefore, jetIsoFilter, jetIsomafter}
  #path p4 = {makeWeights & makeGenEvt,ttSemiLeptonicFilter, allmbefore,allFilter,  allmafter}
  
}
